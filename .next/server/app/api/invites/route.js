"use strict";(()=>{var e={};e.id=264,e.ids=[264],e.modules={3524:e=>{e.exports=require("@prisma/client")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9491:e=>{e.exports=require("assert")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},1808:e=>{e.exports=require("net")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},1576:e=>{e.exports=require("string_decoder")},4404:e=>{e.exports=require("tls")},6224:e=>{e.exports=require("tty")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},5805:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>m,originalPathname:()=>x,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>c,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>v});var i={};t.r(i),t.d(i,{POST:()=>POST}),t(8976);var a=t(884),s=t(6132),o=t(5798),n=t(9966);async function devAuthGuard(e){return null}t(5204);var u=t(9625);async function POST(e){let r="";try{if(e?.url){let t=new URL(e.url);r=t.pathname}}catch(e){console.warn("app/api/invites: could not parse request.url",e),r=""}try{let t=await e.json();if(r.endsWith("/api/invites")){let r=await devAuthGuard(e)||{email:t._actor};if(!r||!r.email)return o.Z.json({error:"forbidden"},{status:403});let i=await (0,u.h)(`create:${r.email}`,60,3600);if(!i.allowed)return o.Z.json({error:"rate_limited"},{status:429});let a=await (0,n.l8)(r.email,{email:t.invitedEmail,squadId:t.squadId,role:t.invitedRole});return o.Z.json(a,{status:201})}if(r.match(/\/api\/invites\/.*\/regenerate$/)){let i=await devAuthGuard(e)||{email:t._actor};if(!i||!i.email)return o.Z.json({error:"forbidden"},{status:403});let a=r.split("/").slice(-2,-1)[0],s=await (0,u.h)(`regen:${i.email}`,60,3600);if(!s.allowed)return o.Z.json({error:"rate_limited"},{status:429});let l=await (0,n.aG)(i.email,a);return o.Z.json(l)}if(r.match(/\/api\/invites\/.*\/revoke$/)){let i=await devAuthGuard(e)||{email:t._actor};if(!i||!i.email)return o.Z.json({error:"forbidden"},{status:403});let a=r.split("/").slice(-2,-1)[0],s=await (0,u.h)(`revoke:${i.email}`,60,3600);if(!s.allowed)return o.Z.json({error:"rate_limited"},{status:429});let l=await (0,n.GY)(i.email,a);return o.Z.json(l)}return o.Z.json({error:"unknown action"},{status:400})}catch(e){return console.error(e),o.Z.json({error:"server error"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/invites/route",pathname:"/api/invites",filename:"route",bundlePath:"app/api/invites/route"},resolvedPagePath:"/Users/fseguerra/Projects/sprintCap/app/api/invites/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:c,headerHooks:m,staticGenerationBailout:v}=l,x="/api/invites/route"}};var r=require("../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[955,277,673],()=>__webpack_exec__(5805));module.exports=t})();