(()=>{var e={};e.id=3,e.ids=[3],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6008:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>r.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var a=s(7096),i=s(6132),n=s(7284),r=s.n(n),l=s(2564),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,3729)),"/Users/fseguerra/Projects/sprintCap/app/admin/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,7134)),"/Users/fseguerra/Projects/sprintCap/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/fseguerra/Projects/sprintCap/app/admin/page.tsx"],u="/admin/page",p={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3115:(e,t,s)=>{Promise.resolve().then(s.bind(s,4082))},4082:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>AdminPage});var a=s(784),i=s(9885),n=s(7114);function AdminPage(){let[e,t]=(0,i.useState)(""),[s,r]=(0,i.useState)("MEMBER"),[l,o]=(0,i.useState)(!1),[d,c]=(0,i.useState)(null),[u,p]=(0,i.useState)([]),[x,m]=(0,i.useState)(!1);async function fetchInvites(){m(!0);try{let e=new URLSearchParams;e.set("limit","20"),h&&e.set("status",h),g&&e.set("q",g),f&&e.set("cursor",f);let t=await fetch("/api/invite?"+e.toString());if(t.ok){let e=await t.json();p(e.invites||[]),w(e.nextCursor||null)}}catch(e){console.warn("failed to fetch invites",e)}m(!1)}(0,n.useRouter)();let[h,v]=(0,i.useState)(void 0),[g,b]=(0,i.useState)(""),[f,j]=(0,i.useState)(null),[y,w]=(0,i.useState)(null),[N,k]=(0,i.useState)(null);async function handleSubmit(a){a.preventDefault(),o(!0),c(null);try{let a=await fetch("/api/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,role:s})});if(a.ok){let e=await a.json();c("Invite created: "+e.id),t("");let s=`${window.location.origin}/accept-invite?token=${e.token}`;navigator.clipboard?.writeText(s),await fetchInvites()}else{let e=await a.json();c("Error: "+(e.error||"unknown"))}}catch(e){c("Error: "+e.message)}o(!1)}async function handleCopy(e){try{let t=await fetch("/api/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"regenerate",inviteId:e.id})});if(!t.ok)throw Error("failed to regenerate");let s=await t.json(),a=`${window.location.origin}/accept-invite?token=${s.token}`;await navigator.clipboard.writeText(a),c("Copied accept link to clipboard"),await fetchInvites()}catch(e){c("Error copying link: "+e.message)}}return(0,i.useEffect)(()=>{fetchInvites()},[]),(0,a.jsxs)("main",{className:"min-h-screen flex flex-col items-center bg-white p-8",children:[a.jsx("section",{className:"w-full max-w-2xl bg-gray-50 p-6 rounded-md shadow mb-6",children:(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"",children:[a.jsx("h2",{className:"text-2xl mb-4",children:"Admin - Create Invite"}),a.jsx("label",{className:"block mb-2 text-sm",children:"Email"}),a.jsx("input",{"data-testid":"invite-email-input",className:"w-full mb-4 p-2 border rounded",value:e,onChange:e=>t(e.target.value)}),a.jsx("label",{className:"block mb-2 text-sm",children:"Role"}),(0,a.jsxs)("select",{className:"w-full mb-4 p-2 border rounded",value:s,onChange:e=>r(e.target.value),children:[a.jsx("option",{value:"MEMBER",children:"Member"}),a.jsx("option",{value:"SCRUM_MASTER",children:"Scrum Master"}),a.jsx("option",{value:"ADMIN",children:"Admin"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{"data-testid":"create-invite-btn",className:"py-2 px-4 bg-black text-white rounded",disabled:l,children:l?"Working...":"Create Invite"}),a.jsx("button",{"data-testid":"refresh-invites-btn",type:"button",className:"py-2 px-4 bg-white border rounded",onClick:fetchInvites,disabled:x,children:x?"Refreshing...":"Refresh"})]}),d&&a.jsx("p",{className:"mt-4 text-sm",children:d})]})}),(0,a.jsxs)("section",{className:"w-full max-w-2xl",children:[a.jsx("h3",{className:"text-lg mb-2",children:"Recent Invites"}),(0,a.jsxs)("div",{className:"p-4 flex gap-2 items-center",children:[a.jsx("input",{"data-testid":"search-invites-input",className:"p-2 border rounded",placeholder:"Search email",value:g,onChange:e=>b(e.target.value)}),(0,a.jsxs)("select",{className:"p-2 border rounded",value:h||"",onChange:e=>v(e.target.value||void 0),children:[a.jsx("option",{value:"",children:"All"}),a.jsx("option",{value:"PENDING",children:"PENDING"}),a.jsx("option",{value:"ACCEPTED",children:"ACCEPTED"}),a.jsx("option",{value:"EXPIRED",children:"EXPIRED"})]}),a.jsx("button",{className:"py-1 px-3 bg-gray-200 rounded",onClick:()=>{j(null),fetchInvites()},children:"Apply"})]}),(0,a.jsxs)("div",{className:"bg-white border rounded",children:[0===u.length&&a.jsx("div",{className:"p-4 text-sm text-gray-500",children:"No invites yet"}),u.map(e=>(0,a.jsxs)("div",{"data-testid":`invite-row-${e.id}`,className:"p-3 border-b flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:e.email}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Role: ",e.invitedRole||"MEMBER"," • Expires: ",new Date(e.expiresAt).toLocaleString()," • Status: ",a.jsx("span",{"data-testid":`invite-status-${e.id}`,className:"font-semibold",children:e.status||"PENDING"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{"data-testid":`copy-link-${e.id}`,className:"py-1 px-2 bg-blue-600 text-white rounded text-sm",onClick:()=>handleCopy(e),children:"Copy Accept Link"}),e&&"PENDING"===e.status&&a.jsx("button",{"data-testid":`revoke-btn-${e.id}`,className:"py-1 px-2 bg-red-600 text-white rounded text-sm",onClick:()=>k(e),children:"Revoke"})]})]},e.id))]}),a.jsx("div",{className:"mt-3 flex justify-center",children:y?a.jsx("button",{className:"py-1 px-3 bg-gray-800 text-white rounded",onClick:()=>{j(y),fetchInvites()},children:"Load more"}):null}),N&&a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded shadow max-w-md w-full",children:[a.jsx("h4",{className:"text-lg mb-2",children:"Revoke Invite"}),(0,a.jsxs)("p",{className:"text-sm mb-4",children:["Are you sure you want to revoke the invite for ",a.jsx("strong",{children:N.email}),"? This cannot be undone."]}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[a.jsx("button",{"data-testid":"modal-cancel",className:"px-3 py-1 border rounded",onClick:()=>k(null),children:"Cancel"}),a.jsx("button",{"data-testid":"modal-revoke-confirm",className:"px-3 py-1 bg-red-600 text-white rounded",onClick:async()=>{try{let e=await fetch("/api/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"revoke",inviteId:N.id})});if(e.ok)c("Invite revoked"),k(null),await fetchInvites();else{let t=await e.json();c("Error: "+(t.error||"revoke failed"))}}catch(e){c("Error: "+e.message)}},children:"Revoke"})]})]})})]})]})}},3729:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>n,default:()=>o});var a=s(5153);let i=(0,a.createProxy)(String.raw`/Users/fseguerra/Projects/sprintCap/app/admin/page.tsx`),{__esModule:n,$$typeof:r}=i,l=i.default,o=l},7114:(e,t,s)=>{e.exports=s(4979)}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[73,872],()=>__webpack_exec__(6008));module.exports=s})();